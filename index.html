<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>생각박사 꾸꾸 - 초등학생용 AI 친구</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .animate-bounce { animation: bounce 1s infinite; }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0,-30px,0); }
            70% { transform: translate3d(0,-15px,0); }
            90% { transform: translate3d(0,-4px,0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Lucide Icons as SVG components
        const Send = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="m22 2-7 20-4-9-9-4Z"/>
                <path d="M22 2 11 13"/>
            </svg>
        );

        const RotateCcw = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const Heart = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7Z"/>
            </svg>
        );

        const Star = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
            </svg>
        );

        const Smile = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="m9 9 1.5 1.5L12 9l1.5 1.5L15 9"/>
                <path d="M8 15s1.5 2 4 2 4-2 4-2"/>
            </svg>
        );

        const KidsAIFriend = () => {
            const [messages, setMessages] = useState([
                {
                    role: 'assistant',
                    content: '안녕! 나는 생각박사 꾸꾸야! 😊\n\n궁금한 게 있거나 이야기하고 싶은 게 있으면 언제든 말해줘!\n\n함께 재미있게 대화해보자! ✨'
                }
            ]);
            const [currentMessage, setCurrentMessage] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            // 즉시 응답 데이터베이스 - 동화 만들기 중심으로 개선
            const instantResponses = {
                // 인사말 - 동화 만들기로 유도
                '안녕': ['안녕! 나는 생각박사 꾸꾸야! 😊 너와 함께 멋진 동화를 만들어보고 싶어! 어떤 이야기가 좋을까? 마법 이야기? 아니면 동물 친구들 이야기?', '안녕! 반가워! ✨ 오늘 우리 함께 특별한 동화책을 만들어볼까? 네가 상상하는 재미있는 캐릭터가 있어?'],
                '안녕!': ['안녕! 생각박사 꾸꾸야! 🌟 너랑 이야기하면서 동화를 만들면 정말 재미있을 것 같아! 혹시 좋아하는 동물이나 캐릭터가 있어? 그걸로 이야기를 시작해보자!', '안녕! 오늘 기분은 어때? 😄 기분 좋을 때 만드는 이야기가 가장 재미있거든! 어떤 모험 이야기를 만들어볼까?'],
                '안녕하세요': ['안녕하세요! 생각박사 꾸꾸예요! ✨ 정말 예의바르게 인사해주는구나! 예의바른 주인공이 나오는 동화는 어떨까? 아니면 네가 직접 주인공이 되는 이야기는?'],
                
                // 감정 표현을 동화로 연결
                '심심해': ['심심하구나! 그럼 우리가 직접 재미있는 이야기를 만들어보면 어떨까? 🤔 심심한 주인공이 나오는 이야기를 만들어보자! 심심한 주인공이 어떤 모험을 하게 될까? 혹시 마법의 문을 발견하게 될까? 아니면 신비한 친구를 만나게 될까?'],
                '화나': ['화가 나는구나... 🤗 그런 기분일 때는 이야기 속에서 마음을 표현해보는 게 좋아! 화가 난 주인공이 나오는 동화를 만들어보자. 그 주인공은 화를 어떻게 해결했을까? 친구의 도움을 받았을까? 아니면 스스로 좋은 방법을 찾았을까?'],
                '기뻐': ['와! 기쁘다니 나도 기뻐! 🎉 기쁜 마음으로 만드는 이야기는 정말 특별해! 행복한 주인공이 나오는 동화를 만들어보자. 그 주인공은 왜 그렇게 기뻤을까? 친구들과 함께 했기 때문일까?'],
                '슬퍼': ['슬프구나... 괜찮아, 내가 옆에 있어! 🤗 슬픈 마음도 아름다운 이야기로 만들 수 있어. 슬픈 주인공이 어떻게 다시 웃게 되었는지 이야기를 만들어보자. 따뜻한 친구가 나타났을까? 아니면 신기한 마법이 일어났을까?'],
                
                // 동화 관련 직접 응답
                '동화': ['동화 이야기구나! 정말 좋아해! 📚✨ 우리 함께 새로운 동화를 만들어보자! 먼저 주인공부터 정해볼까? 사람? 동물? 아니면 상상 속 친구? 그리고 그 주인공은 어떤 성격일까? 용감할까? 친절할까?'],
                '이야기': ['이야기! 내가 가장 좋아하는 것 중 하나야! 😊 우리가 함께 만드는 이야기는 세상에 하나뿐인 특별한 이야기가 될 거야! 어떤 배경에서 일어나는 이야기면 좋을까? 숲? 바다? 우주? 아니면 네 상상 속 어떤 곳?'],
                
                // 기본 대화도 동화로 연결
                '뭐해': ['나는 지금 너와 함께 만들 멋진 동화 이야기를 생각하고 있었어! 😄 너는 뭐하고 있었어? 혹시 재미있는 일이 있었다면 그걸로 이야기를 만들어볼 수 있을 것 같은데!'],
                '놀자': ['좋아! 🎮 가장 재미있는 놀이는 이야기 만들기야! 우리 함께 상상력을 발휘해서 멋진 동화를 만들어보자! 모험 이야기? 판타지? 아니면 일상 이야기? 어떤 게 좋을까?']
            };

            // 키워드 기반 스마트 응답 - 동화 만들기 중심으로 확장
            const getSmartResponse = (message) => {
                const msg = message.toLowerCase().replace(/[!?.,\s]/g, '');
                
                // 나쁜 말 체크
                const badWords = ['바보', '멍청', '죽어', '싫어'];
                if (badWords.some(word => msg.includes(word))) {
                    return '그런 말은 좋지 않아! 😊 대신 멋진 이야기를 만들어보자! 착한 주인공이 나쁜 말을 좋은 말로 바꾸는 마법 이야기는 어떨까?';
                }
                
                // 동화/이야기 관련 키워드
                if (msg.includes('공주') || msg.includes('왕자')) {
                    return '공주나 왕자 이야기! 정말 멋져! ✨ 어떤 공주(왕자) 이야기를 만들어볼까? 용감한 공주? 친절한 왕자? 그들은 어떤 모험을 하게 될까? 혹시 마법의 성에서 일어나는 이야기는?';
                }
                if (msg.includes('마법') || msg.includes('마술')) {
                    return '마법 이야기! 정말 신기해! 🪄✨ 어떤 마법이 나오는 이야기를 만들어볼까? 착한 마법사? 마법의 지팡이? 아니면 마법의 동물 친구들? 그 마법으로 어떤 일이 벌어질까?';
                }
                if (msg.includes('동물')) {
                    return '동물 친구들 이야기구나! 🐯🐰🐼 어떤 동물이 주인공이면 좋을까? 그 동물 친구는 어떤 성격일까? 장난꾸러기? 똑똑이? 그리고 다른 동물 친구들과 어떤 모험을 하게 될까? 숲에서? 바다에서?';
                }
                if (msg.includes('우주') || msg.includes('별')) {
                    return '우주 모험 이야기! 정말 멋진 아이디어야! 🚀⭐ 주인공이 우주선을 타고 어디로 갈까? 다른 행성? 그곳에서 어떤 외계인 친구들을 만날까? 그들과 어떤 재미있는 일이 벌어질까?';
                }
                if (msg.includes('바다') || msg.includes('물고기')) {
                    return '바다 이야기! 신비롭고 아름다워! 🌊🐠 바다 속에서 어떤 모험이 펼쳐질까? 인어 친구들? 보물섬? 아니면 착한 고래와의 여행? 파도 소리와 함께 어떤 이야기가 시작될까?';
                }
                if (msg.includes('친구') || msg.includes('우정')) {
                    return '친구와 우정 이야기! 정말 따뜻해! 👫💕 어떤 친구들이 나올까? 서로 다른 성격의 친구들? 그들이 어떻게 만나게 되었을까? 그리고 함께 어떤 어려움을 극복하게 될까? 우정의 힘으로!';
                }
                if (msg.includes('학교') || msg.includes('선생님')) {
                    return '학교 이야기구나! 📚✏️ 학교에서 어떤 재미있는 일이 벌어질까? 새로운 친구를 만나는 이야기? 특별한 선생님과의 이야기? 아니면 학교에서 일어나는 신기한 모험? 어떤 이야기를 만들어보고 싶어?';
                }
                if (msg.includes('가족') || msg.includes('엄마') || msg.includes('아빠')) {
                    return '가족 이야기! 정말 소중해! 👨‍👩‍👧‍👦💖 어떤 가족 이야기를 만들어볼까? 가족과 함께하는 여행? 특별한 가족의 비밀? 아니면 가족이 함께 해결하는 문제? 사랑이 가득한 이야기!';
                }
                if (msg.includes('모험') || msg.includes('여행')) {
                    return '모험과 여행 이야기! 정말 흥미진진해! 🗺️⛰️ 주인공이 어디로 모험을 떠날까? 미지의 땅? 신비한 섬? 그곳에서 어떤 친구들을 만나고, 어떤 도전을 하게 될까? 상상만 해도 설레는걸!';
                }
                
                // 감정을 이야기로 연결
                if (msg.includes('무서')) {
                    return '무서운 마음이구나... 괜찮아! 🤗 무서울 때는 용기를 내는 주인공 이야기를 만들어보면 어떨까? 처음엔 무서워했지만 친구들의 도움으로 용감해진 이야기! 그럼 너도 용기가 생길 거야!';
                }
                if (msg.includes('행복') || msg.includes('즐거')) {
                    return '행복한 기분이구나! 😊🎉 행복한 마음으로 만드는 이야기는 정말 특별해! 모든 캐릭터들이 웃고 즐거워하는 이야기를 만들어보자! 그들은 무엇 때문에 그렇게 행복할까?';
                }
                
                // 색깔을 이야기로 연결
                if (msg.includes('빨간') || msg.includes('파란') || msg.includes('노란')) {
                    return '색깔 이야기! 🌈 색깔마다 특별한 의미가 있어! 그 색깔이 주인공인 이야기는 어떨까? 빨간색 친구는 열정적이고, 파란색 친구는 차분하고, 노란색 친구는 밝고 명랑해! 어떤 색깔 친구들의 모험을 만들어볼까?';
                }
                
                return null;
            };

            const sendMessage = () => {
                if (!currentMessage.trim()) return;

                const userMessage = currentMessage.trim();
                setCurrentMessage('');

                // 사용자 메시지 추가
                const newMessages = [...messages, { role: 'user', content: userMessage }];
                setMessages(newMessages);
                
                // 로딩 표시 (즉시 응답을 위해 아주 짧게)
                setIsLoading(true);
                
                setTimeout(() => {
                    let response = null;
                    const normalizedMsg = userMessage.toLowerCase().replace(/[!?.,\s]/g, '');
                    
                    // 1. 정확한 매칭 확인
                    if (instantResponses[normalizedMsg]) {
                        const responses = instantResponses[normalizedMsg];
                        response = responses[Math.floor(Math.random() * responses.length)];
                    }
                    // 2. 스마트 응답 확인
                    else {
                        response = getSmartResponse(userMessage);
                    }
                    // 3. 기본 응답 - 대화를 이어가고 동화로 유도
                    if (!response) {
                        const defaultResponses = [
                            '정말 흥미로운 이야기네! 그걸로 동화를 만들어보면 어떨까? 🤔✨ 주인공은 누가 될까? 그리고 어떤 모험이 시작될까?',
                            '와! 그런 생각을 하는구나! 😊 그것도 멋진 이야기 소재가 될 수 있을 것 같은데? 어떤 식으로 이야기를 풀어나가고 싶어?',
                            '오호! 재미있는 이야기네! 📚 더 들려줘! 그리고 그 이야기에 어떤 친구들이 나오면 좋을까? 동물 친구? 사람 친구?',
                            '그렇구나! 정말 멋진 아이디어야! 🌟 그걸로 우리만의 특별한 동화를 만들어보자! 어떤 배경에서 일어나는 이야기면 좋을까?',
                            '우와! 상상력이 정말 대단해! 👏 그런 이야기라면 다른 사람들도 정말 좋아할 것 같아! 계속해서 어떤 일이 벌어질까?',
                            '정말 창의적인 생각이야! 🎨 그 아이디어를 바탕으로 동화책을 만든다면 어떨까? 그림도 그리고 싶어지는 이야기네!',
                            '너무 재미있어! 😄 그 이야기에서 주인공이 어떤 어려움을 만나게 될까? 그리고 어떻게 해결할까? 친구들의 도움? 아니면 자신만의 방법?'
                        ];
                        response = defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
                    }
                    
                    setMessages(prev => [...prev, { role: 'assistant', content: response }]);
                    setIsLoading(false);
                }, 100); // 0.1초만 대기
            };

            const resetChat = () => {
                setMessages([
                    {
                        role: 'assistant',
                        content: '안녕! 나는 생각박사 꾸꾸야! 😊\n\n궁금한 게 있거나 이야기하고 싶은 게 있으면 언제든 말해줘!\n\n함께 재미있게 대화해보자! ✨'
                    }
                ]);
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            };

            const quickMessages = [
                "안녕! 😊",
                "동화 만들고 싶어",
                "공주 이야기 해줘",
                "동물 친구들",
                "우주 모험!",
                "마법 이야기"
            ];

            return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-pink-100 via-purple-50 to-blue-100 flex flex-col" },
                // Header
                React.createElement('div', { className: "bg-white shadow-lg border-b-4 border-purple-200 p-4" },
                    React.createElement('div', { className: "max-w-4xl mx-auto flex items-center justify-between" },
                        React.createElement('div', { className: "flex items-center gap-3" },
                            React.createElement('div', { className: "w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center" },
                                React.createElement(Heart)
                            ),
                            React.createElement('div', null,
                                React.createElement('h1', { className: "text-2xl font-bold text-purple-800" }, '생각박사 꾸꾸'),
                                React.createElement('p', { className: "text-sm text-gray-600" }, '빠르고 안전한 대화 친구 🧠⚡')
                            )
                        ),
                        React.createElement('button', { 
                            onClick: resetChat,
                            className: "bg-purple-500 text-white px-4 py-2 rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2 shadow-lg"
                        },
                            React.createElement(RotateCcw),
                            '새로 시작'
                        )
                    )
                ),
                
                // Messages
                React.createElement('div', { className: "flex-1 max-w-4xl mx-auto w-full p-4 overflow-y-auto" },
                    React.createElement('div', { className: "space-y-4" },
                        ...messages.map((message, index) =>
                            React.createElement('div', {
                                key: index,
                                className: `flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`
                            },
                                React.createElement('div', {
                                    className: `max-w-xs md:max-w-md lg:max-w-lg p-4 rounded-2xl shadow-lg ${
                                        message.role === 'user'
                                            ? 'bg-purple-500 text-white ml-4'
                                            : 'bg-white text-gray-800 mr-4 border-2 border-purple-100'
                                    }`
                                },
                                    message.role === 'assistant' && React.createElement('div', { className: "flex items-center gap-2 mb-2" },
                                        React.createElement(Smile, { className: "w-5 h-5 text-purple-500" }),
                                        React.createElement('span', { className: "font-semibold text-purple-600" }, '생각박사 꾸꾸')
                                    ),
                                    React.createElement('div', { 
                                        className: "whitespace-pre-line text-sm md:text-base leading-relaxed",
                                        style: { whiteSpace: 'pre-line' }
                                    }, message.content)
                                )
                            )
                        ),
                        
                        isLoading && React.createElement('div', { className: "flex justify-start" },
                            React.createElement('div', { className: "bg-white p-4 rounded-2xl shadow-lg mr-4 border-2 border-purple-100" },
                                React.createElement('div', { className: "flex items-center gap-2 mb-2" },
                                    React.createElement(Smile, { className: "w-5 h-5 text-purple-500" }),
                                    React.createElement('span', { className: "font-semibold text-purple-600" }, '생각박사 꾸꾸')
                                ),
                                React.createElement('div', { className: "flex items-center gap-2" },
                                    React.createElement('div', { className: "flex space-x-1" },
                                        React.createElement('div', { className: "w-2 h-2 bg-purple-400 rounded-full animate-bounce" }),
                                        React.createElement('div', { className: "w-2 h-2 bg-pink-400 rounded-full animate-bounce", style: { animationDelay: '0.1s' } }),
                                        React.createElement('div', { className: "w-2 h-2 bg-blue-400 rounded-full animate-bounce", style: { animationDelay: '0.2s' } })
                                    ),
                                    React.createElement('span', { className: "text-gray-500 text-sm" }, '생각중...')
                                )
                            )
                        ),
                        
                        React.createElement('div', { ref: messagesEndRef })
                    )
                ),
                
                // Quick Messages
                messages.length === 1 && React.createElement('div', { className: "max-w-4xl mx-auto w-full px-4 pb-4" },
                    React.createElement('div', { className: "bg-white rounded-2xl shadow-lg p-4 border-2 border-purple-100" },
                        React.createElement('h3', { className: "text-lg font-semibold text-purple-700 mb-3 flex items-center gap-2" },
                            React.createElement(Star),
                            '이런 말을 해볼까요?'
                        ),
                        React.createElement('div', { className: "grid grid-cols-2 md:grid-cols-3 gap-2" },
                            ...quickMessages.map((msg, index) =>
                                React.createElement('button', {
                                    key: index,
                                    onClick: () => setCurrentMessage(msg),
                                    className: "bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 px-3 py-2 rounded-xl hover:from-purple-200 hover:to-pink-200 transition-colors text-sm font-medium border border-purple-200"
                                }, msg)
                            )
                        )
                    )
                ),
                
                // Input
                React.createElement('div', { className: "bg-white border-t-4 border-purple-200 p-4 shadow-lg" },
                    React.createElement('div', { className: "max-w-4xl mx-auto" },
                        React.createElement('div', { className: "flex items-center gap-3" },
                            React.createElement('div', { className: "flex-1 relative" },
                                React.createElement('textarea', {
                                    value: currentMessage,
                                    onChange: (e) => setCurrentMessage(e.target.value),
                                    onKeyPress: handleKeyPress,
                                    placeholder: "여기에 메시지를 입력해주세요... 😊",
                                    rows: 1,
                                    className: "w-full p-4 pr-12 border-2 border-purple-200 rounded-2xl focus:border-purple-500 focus:outline-none resize-none text-base",
                                    style: { minHeight: '56px', maxHeight: '120px' }
                                })
                            ),
                            React.createElement('button', {
                                onClick: sendMessage,
                                disabled: !currentMessage.trim() || isLoading,
                                className: "bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 rounded-2xl hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg"
                            },
                                React.createElement(Send)
                            )
                        )
                    )
                ),
                
                // Safety & Speed Notice
                React.createElement('div', { className: "bg-green-50 border-t-2 border-green-200 p-3" },
                    React.createElement('div', { className: "max-w-4xl mx-auto text-center" },
                        React.createElement('p', { className: "text-green-700 text-sm font-medium" },
                            '⚡ 초고속 응답! 🛡️ 안전한 대화! 언제든 선생님이나 부모님과 함께 사용해주세요'
                        )
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(KidsAIFriend), document.getElementById('root'));
    </script>
</body>
</html>
