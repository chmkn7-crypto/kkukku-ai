<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>생각박사 꾸꾸 - 초등학생용 AI 친구</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .animate-bounce { animation: bounce 1s infinite; }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0,-30px,0); }
            70% { transform: translate3d(0,-15px,0); }
            90% { transform: translate3d(0,-4px,0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Lucide Icons as SVG components
        const Send = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="m22 2-7 20-4-9-9-4Z"/>
                <path d="M22 2 11 13"/>
            </svg>
        );

        const RotateCcw = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const Heart = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7Z"/>
            </svg>
        );

        const Star = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"/>
            </svg>
        );

        const Smile = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="m9 9 1.5 1.5L12 9l1.5 1.5L15 9"/>
                <path d="M8 15s1.5 2 4 2 4-2 4-2"/>
            </svg>
        );

        const KidsAIFriend = () => {
            const [messages, setMessages] = useState([
                {
                    role: 'assistant',
                    content: '안녕! 나는 생각박사 꾸꾸야! 😊\n\n궁금한 게 있거나 이야기하고 싶은 게 있으면 언제든 말해줘!\n\n함께 재미있게 대화해보자! ✨'
                }
            ]);
            const [currentMessage, setCurrentMessage] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const sendMessage = async () => {
                if (!currentMessage.trim() || isLoading) return;

                const userMessage = currentMessage.trim();
                setCurrentMessage('');
                setError('');

                // 사용자 메시지 추가
                const newMessages = [...messages, { role: 'user', content: userMessage }];
                setMessages(newMessages);
                
                // 즉시 응답 시스템 - 자연스럽고 대화 이어지는 버전
                const getQuickResponse = (msg) => {
                    const m = msg.toLowerCase().trim();
                    
                    // 인사
                    if (m.includes('안녕')) {
                        return ['안녕! 나는 생각박사 꾸꾸야! 😊 오늘 어떤 하루를 보냈어? 뭔가 재미있는 일이 있었나?', '안녕! 반가워! ✨ 너를 만나게 되어서 정말 기뻐! 오늘 기분은 어때? 좋은 일이 있었어?'][Math.floor(Math.random() * 2)];
                    }
                    
                    // 감정
                    if (m.includes('심심')) {
                        return '심심하구나! 그럼 재미있는 이야기를 하나 만들어볼까? 😄 너는 어떤 모험을 해보고 싶어? 숲 속 탐험? 바다 여행? 아니면 우주 모험?';
                    }
                    if (m.includes('화') || m.includes('짜증')) {
                        return '화가 나는구나... 무슨 일이야? 🤗 이야기해주면 기분이 나아질 수도 있어. 그리고 화가 난 주인공이 나오는 재미있는 이야기도 만들 수 있을 것 같은데!';
                    }
                    if (m.includes('기뻐') || m.includes('행복')) {
                        return '와! 기쁘다니 나도 덩달아 기뻐져! 🎉 무슨 좋은 일이 있었어? 그 기쁜 마음으로 신나는 이야기를 만들면 정말 멋질 것 같아!';
                    }
                    if (m.includes('슬프') || m.includes('속상')) {
                        return '슬프구나... 괜찮아, 내가 여기 있어! 🤗 힘든 일이 있었나? 이야기해주면 마음이 좀 나아질까? 따뜻한 이야기도 함께 만들어보자!';
                    }
                    
                    // 질문들
                    if (m.includes('뭐해') || m.includes('뭐하')) {
                        return '나는 너와 재미있는 이야기를 나누고 있어! 😊 너는 뭐하고 있었어? 혹시 학교에서 있었던 재미있는 일이나, 친구들과 있었던 일 얘기해줄래?';
                    }
                    if (m.includes('이름')) {
                        return '내 이름은 생각박사 꾸꾸야! 🧠✨ 아이들과 이야기하고 상상하는 걸 제일 좋아해! 너는 어떤 이름을 가진 주인공이 나오는 이야기를 좋아해?';
                    }
                    
                    // 놀이/게임
                    if (m.includes('놀자') || m.includes('게임')) {
                        return '좋아! 놀자! 🎮 상상놀이는 어때? 우리가 함께 멋진 이야기를 만들어보는 거야! 너는 어떤 캐릭터가 되고 싶어? 용감한 기사? 똑똑한 탐정? 아니면 마법사?';
                    }
                    if (m.includes('이야기') || m.includes('동화')) {
                        return '이야기! 내가 가장 좋아하는 거야! 📚✨ 어떤 이야기를 만들어볼까? 모험 이야기? 친구 이야기? 아니면 마법 이야기? 네가 상상하는 재미있는 아이디어 들려줘!';
                    }
                    
                    // 동물/자연
                    if (m.includes('동물')) {
                        return '동물들! 정말 좋아해! 🐯🐰🦒 어떤 동물을 가장 좋아해? 그 동물이 주인공인 이야기를 만들어보면 어떨까? 그 동물 친구는 어떤 성격일까?';
                    }
                    if (m.includes('꽃') || m.includes('나무')) {
                        return '자연 이야기구나! 🌸🌳 정말 아름다워! 마법의 숲이나 신비한 정원 이야기는 어떨까? 그곳에서 어떤 특별한 일들이 일어날 수 있을까?';
                    }
                    
                    // 학교/친구
                    if (m.includes('학교')) {
                        return '학교 얘기구나! 📚 오늘 학교에서 재미있는 일이 있었어? 친구들과 뭘 했어? 학교에서 일어나는 신기한 모험 이야기도 만들 수 있을 것 같은데!';
                    }
                    if (m.includes('친구')) {
                        return '친구 이야기! 친구는 정말 소중하지! 👫💕 어떤 친구들이 있어? 친구들과 함께하는 모험 이야기를 만들어보면 재미있을 것 같아!';
                    }
                    
                    // 가족
                    if (m.includes('엄마') || m.includes('아빠') || m.includes('가족')) {
                        return '가족 이야기구나! 가족은 정말 특별해! 👨‍👩‍👧‍👦💖 가족과 함께 어떤 일들을 해? 가족과 함께하는 따뜻한 이야기를 만들어보는 건 어떨까?';
                    }
                    
                    // 색깔/그림
                    if (m.includes('빨간') || m.includes('파란') || m.includes('색')) {
                        return '색깔 이야기! 🌈 색깔들이 모두 다른 성격을 가지고 있다면 어떨까? 빨간색은 열정적이고, 파란색은 차분하고... 어떤 색깔 친구들의 이야기를 만들어볼까?';
                    }
                    
                    return null;
                };
                
                const quickResponse = getQuickResponse(userMessage);
                
                if (quickResponse) {
                    // 0.5초 후 즉시 응답
                    setTimeout(() => {
                        setMessages(prev => [...prev, { role: 'assistant', content: quickResponse }]);
                    }, 500);
                } else {
                    // 일반적인 호응 응답들
                    const generalResponses = [
                        `${userMessage}? 정말 흥미롭네! 😊 그거에 대해 더 자세히 말해줄래? 어떤 기분이었어?`,
                        `와! ${userMessage}라니! 정말 재미있겠다! ✨ 그때 어떤 생각이 들었어? 더 이야기해줘!`,
                        `${userMessage}! 그거 정말 멋진 이야기 소재가 될 것 같아! 🌟 그걸로 상상의 이야기를 만들어보면 어떨까?`,
                        `오호! ${userMessage} 이야기구나! 📚 그거 정말 흥미로워! 비슷한 경험이 또 있어?`,
                        `${userMessage}? 우와, 상상력이 정말 풍부하다! 🎨 그런 상상으로 멋진 동화를 만들 수 있을 것 같아!`
                    ];
                    
                    const response = generalResponses[Math.floor(Math.random() * generalResponses.length)];
                    
                    setTimeout(() => {
                        setMessages(prev => [...prev, { role: 'assistant', content: response }]);
                    }, 300);
                }
            };

            const resetChat = () => {
                setMessages([
                    {
                        role: 'assistant',
                        content: '안녕! 나는 생각박사 꾸꾸야! 😊\n\n궁금한 게 있거나 이야기하고 싶은 게 있으면 언제든 말해줘!\n\n함께 재미있게 대화해보자! ✨'
                    }
                ]);
                setError('');
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            };

            const quickMessages = [
                "안녕! 😊",
                "오늘 뭐 했어?",
                "심심해",
                "재미있는 이야기 해줘",
                "같이 놀자!",
                "궁금한 게 있어"
            ];

            return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-pink-100 via-purple-50 to-blue-100 flex flex-col" },
                // Header
                React.createElement('div', { className: "bg-white shadow-lg border-b-4 border-purple-200 p-4" },
                    React.createElement('div', { className: "max-w-4xl mx-auto flex items-center justify-between" },
                        React.createElement('div', { className: "flex items-center gap-3" },
                            React.createElement('div', { className: "w-12 h-12 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center" },
                                React.createElement(Heart)
                            ),
                            React.createElement('div', null,
                                React.createElement('h1', { className: "text-2xl font-bold text-purple-800" }, '생각박사 꾸꾸'),
                                React.createElement('p', { className: "text-sm text-gray-600" }, '빠르고 안전한 대화 친구 🧠⚡')
                            )
                        ),
                        React.createElement('button', { 
                            onClick: resetChat,
                            className: "bg-purple-500 text-white px-4 py-2 rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2 shadow-lg"
                        },
                            React.createElement(RotateCcw),
                            '새로 시작'
                        )
                    )
                ),
                
                // Messages
                React.createElement('div', { className: "flex-1 max-w-4xl mx-auto w-full p-4 overflow-y-auto" },
                    React.createElement('div', { className: "space-y-4" },
                        ...messages.map((message, index) =>
                            React.createElement('div', {
                                key: index,
                                className: `flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`
                            },
                                React.createElement('div', {
                                    className: `max-w-xs md:max-w-md lg:max-w-lg p-4 rounded-2xl shadow-lg ${
                                        message.role === 'user'
                                            ? 'bg-purple-500 text-white ml-4'
                                            : 'bg-white text-gray-800 mr-4 border-2 border-purple-100'
                                    }`
                                },
                                    message.role === 'assistant' && React.createElement('div', { className: "flex items-center gap-2 mb-2" },
                                        React.createElement(Smile, { className: "w-5 h-5 text-purple-500" }),
                                        React.createElement('span', { className: "font-semibold text-purple-600" }, '생각박사 꾸꾸')
                                    ),
                                    React.createElement('div', { 
                                        className: "whitespace-pre-line text-sm md:text-base leading-relaxed",
                                        style: { whiteSpace: 'pre-line' }
                                    }, message.content)
                                )
                            )
                        ),
                        
                        isLoading && React.createElement('div', { className: "flex justify-start" },
                            React.createElement('div', { className: "bg-white p-4 rounded-2xl shadow-lg mr-4 border-2 border-purple-100" },
                                React.createElement('div', { className: "flex items-center gap-2 mb-2" },
                                    React.createElement(Smile, { className: "w-5 h-5 text-purple-500" }),
                                    React.createElement('span', { className: "font-semibold text-purple-600" }, '생각박사 꾸꾸')
                                ),
                                React.createElement('div', { className: "flex items-center gap-2" },
                                    React.createElement('div', { className: "flex space-x-1" },
                                        React.createElement('div', { className: "w-2 h-2 bg-purple-400 rounded-full animate-bounce" }),
                                        React.createElement('div', { className: "w-2 h-2 bg-pink-400 rounded-full animate-bounce", style: { animationDelay: '0.1s' } }),
                                        React.createElement('div', { className: "w-2 h-2 bg-blue-400 rounded-full animate-bounce", style: { animationDelay: '0.2s' } })
                                    ),
                                    React.createElement('span', { className: "text-gray-500 text-sm" }, '생각중...')
                                )
                            )
                        ),
                        
                        React.createElement('div', { ref: messagesEndRef })
                    )
                ),
                
                // Quick Messages
                messages.length === 1 && React.createElement('div', { className: "max-w-4xl mx-auto w-full px-4 pb-4" },
                    React.createElement('div', { className: "bg-white rounded-2xl shadow-lg p-4 border-2 border-purple-100" },
                        React.createElement('h3', { className: "text-lg font-semibold text-purple-700 mb-3 flex items-center gap-2" },
                            React.createElement(Star),
                            '이런 말을 해볼까요?'
                        ),
                        React.createElement('div', { className: "grid grid-cols-2 md:grid-cols-3 gap-2" },
                            ...quickMessages.map((msg, index) =>
                                React.createElement('button', {
                                    key: index,
                                    onClick: () => setCurrentMessage(msg),
                                    className: "bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 px-3 py-2 rounded-xl hover:from-purple-200 hover:to-pink-200 transition-colors text-sm font-medium border border-purple-200"
                                }, msg)
                            )
                        )
                    )
                ),
                
                // Input
                React.createElement('div', { className: "bg-white border-t-4 border-purple-200 p-4 shadow-lg" },
                    React.createElement('div', { className: "max-w-4xl mx-auto" },
                        React.createElement('div', { className: "flex items-center gap-3" },
                            React.createElement('div', { className: "flex-1 relative" },
                                React.createElement('textarea', {
                                    value: currentMessage,
                                    onChange: (e) => setCurrentMessage(e.target.value),
                                    onKeyPress: handleKeyPress,
                                    placeholder: "여기에 메시지를 입력해주세요... 😊",
                                    rows: 1,
                                    className: "w-full p-4 pr-12 border-2 border-purple-200 rounded-2xl focus:border-purple-500 focus:outline-none resize-none text-base",
                                    style: { minHeight: '56px', maxHeight: '120px' }
                                })
                            ),
                            React.createElement('button', {
                                onClick: sendMessage,
                                disabled: !currentMessage.trim() || isLoading,
                                className: "bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 rounded-2xl hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg"
                            },
                                React.createElement(Send)
                            )
                        )
                    )
                ),
                
                // Safety & Speed Notice
                React.createElement('div', { className: "bg-green-50 border-t-2 border-green-200 p-3" },
                    React.createElement('div', { className: "max-w-4xl mx-auto text-center" },
                        React.createElement('p', { className: "text-green-700 text-sm font-medium" },
                            '⚡ 초고속 응답! 🛡️ 안전한 대화! 언제든 선생님이나 부모님과 함께 사용해주세요'
                        )
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(KidsAIFriend), document.getElementById('root'));
    </script>
</body>
</html>
